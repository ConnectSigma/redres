<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>redres: Redress Your Mixed Model Assumptions • redres</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="redres: Redress Your Mixed Model Assumptions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redres</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/redres-vignette.html">redres: Redress Your Mixed Model Assumptions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/goodekat/redres.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>redres: Redress Your Mixed Model Assumptions</h1>
                        <h4 class="author">R Package Version 0.1.0.9</h4>
            
            <h4 class="date">2019-04-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/goodekat/redres.git/blob/master/vignettes/redres-vignette.Rmd"><code>vignettes/redres-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>redres-vignette.Rmd</code></div>

    </div>

    
    
<div id="introducing-redres" class="section level1">
<h1 class="hasAnchor">
<a href="#introducing-redres" class="anchor"></a>Introducing redres</h1>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>(motivation for the package on having tools for diagnosing mixed models) The Merriam-Webster dictionary defines <a href="https://www.merriam-webster.com/dictionary/redress">redress</a> as “to set right”.</p>
</div>
<div id="package-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#package-structure" class="anchor"></a>Package Structure</h2>
<p>(describe the three ways to use the package)</p>
<p><code>redres</code> contains various functions that provide different ways to assess model assumptions for linear mixed models fit using <code>lmer</code>. The function range from returning a vector of residuals to be used by the user as desired to opening a Shiny app that allows the user to interactively assess the model with package provided tools. A brief description of each function is listed below.</p>
<ul>
<li>
<a href="#redres">redres</a>: computes and returns residuals given a model and a specified residual type</li>
<li>
<a href="#plot_redres">plot_redres</a>: creates a plot of residuals versus fitted values for a given residual type</li>
<li>
<a href="#plot_resqq">plot_resqq</a>: creates a normal quantile plot for conditional residuals</li>
<li>
<a href="#plot_raneff">plot_raneff</a>: creates a normal quantile plot for the random effects</li>
<li>
<a href="#redres_app">redres_app</a>: opens an interactive Shiny app with</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The package can be installed from GitHub using devtools and then loaded in the normal way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Installs redres from GitHub</span>
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"goodekat/redres"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Loads the package</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(redres)</code></pre></div>
</div>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example Data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Prints the first 6 rows of the paprika data</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(paprika)
<span class="co">#&gt; # A tibble: 6 x 5</span>
<span class="co">#&gt;   rep   treatment variety plant height</span>
<span class="co">#&gt;   &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt;   &lt;fct&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1     T1        C1      1       23.5</span>
<span class="co">#&gt; 2 1     T1        C1      2       21.5</span>
<span class="co">#&gt; 3 1     T1        C1      3       31.2</span>
<span class="co">#&gt; 4 1     T1        C1      4       22.1</span>
<span class="co">#&gt; 5 1     T1        C1      5       31.5</span>
<span class="co">#&gt; 6 1     T1        C1      6       26</span>

<span class="co"># Loads the lme4 libraries</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lme4)
<span class="co">#&gt; Loading required package: Matrix</span>
m &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/lme4/topics/lmer">lmer</a></span>(height <span class="op">~</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>treatment<span class="op">*</span>variety <span class="op">+</span><span class="st"> </span>
<span class="st">            </span>(<span class="dv">1</span><span class="op">|</span>rep<span class="op">:</span>treatment) <span class="op">+</span><span class="st"> </span>
<span class="st">            </span>(<span class="dv">1</span><span class="op">|</span>rep<span class="op">:</span>treatment<span class="op">:</span>variety), 
          <span class="dt">data =</span> paprika)</code></pre></div>
</div>
</div>
<div id="extracting-residuals" class="section level1">
<h1 class="hasAnchor">
<a href="#extracting-residuals" class="anchor"></a>Extracting Residuals</h1>
<p>One of the ways to utilize <code>redres</code> is to extract residuals from a model fit using <code>lmer</code>. This can be done using the main function in the package named <code>redres</code> to compute residuals based on a specified type.</p>
<div id="types" class="section level2">
<h2 class="hasAnchor">
<a href="#types" class="anchor"></a>Residual Types</h2>
<p>The linear mixed effects model can be written as <span class="math display">\[\textbf{Y}=\textbf{X}\boldsymbol{\beta}+\textbf{Z}\boldsymbol{\gamma}+\boldsymbol{\epsilon}\]</span> where</p>
<ul>
<li>
<span class="math inline">\(\textbf{Y}\)</span> is an <span class="math inline">\(n\times 1\)</span> vector of <span class="math inline">\(n\)</span> response variable observations,</li>
<li>
<span class="math inline">\(\textbf{X}\)</span> is an <span class="math inline">\(n\times p\)</span> matrix of <span class="math inline">\(p\)</span> explanatory variables with <span class="math inline">\(n\)</span> observations each,</li>
<li>
<span class="math inline">\(\boldsymbol{\beta}\)</span> is a <span class="math inline">\(p\times1\)</span> vector of unknown fixed effects parameters,</li>
<li>
<span class="math inline">\(\textbf{Z}\)</span> is an <span class="math inline">\(n\times q\)</span> matrix of <span class="math inline">\(q\)</span> random effect variables with <span class="math inline">\(n\)</span> observations each,</li>
<li>
<span class="math inline">\(\boldsymbol{\gamma}\)</span> is a <span class="math inline">\(q\times1\)</span> vector of unknown random effects, and</li>
<li>
<span class="math inline">\(\boldsymbol{\epsilon}\)</span> is an <span class="math inline">\(n\times1\)</span> vector of random errors.</li>
</ul>
<p>Under this set up, <span class="math display">\[E[\textbf{Y}]=\textbf{X}\boldsymbol{\beta} \ \ \ \mbox{ and } \ \ \ 
  Var[\textbf{Y}]=\textbf{ZGZ}'+\textbf{R}=\textbf{V}.\]</span></p>
<p>It is assumed that <span class="math display">\[ 
\begin{bmatrix} \boldsymbol{\gamma} \\ \boldsymbol{\epsilon} \end{bmatrix}
\sim N 
\begin{pmatrix} 
\begin{bmatrix} \boldsymbol{0} \\ \boldsymbol{0} \end{bmatrix},
\begin{bmatrix} \textbf{G} &amp; \boldsymbol{0} \\ \boldsymbol{0} &amp; \textbf{R}
\end{bmatrix}
\end{pmatrix}.
\]</span></p>
<p><code>redres</code> can compute six types of residuals. These include some types not available in <code>lme4</code>, and some of the types are computed differently in <code>redres</code> than <code>lme4</code>. These changes were made to make the choices of type names more intuitive with the computations used. The formulas for how these are computed in <code>redres</code> are listed below.</p>
<div id="raw-residuals" class="section level3">
<h3 class="hasAnchor">
<a href="#raw-residuals" class="anchor"></a>Raw Residuals</h3>
<p>The raw residuals are computed as the observed response values minus the predicted response values where the marginal version does not account for the random effects while the conditional version does. These are computed as follows.</p>

<ul>
<li><p><strong>marginal</strong> raw residuals <span class="math display">\[r^m_i = Y_i-\textbf{x}'_i\widehat{\boldsymbol{\beta}}\]</span></p></li>
<li><p><strong>conditional</strong> raw residuals <span class="math display">\[r^c_i = Y_i-\textbf{x}'_i\boldsymbol{\widehat{\beta}}-\textbf{z}'_i\widehat{\boldsymbol{\gamma}}\]</span></p></li>
</ul>
</div>
<div id="pearson-residuals" class="section level3">
<h3 class="hasAnchor">
<a href="#pearson-residuals" class="anchor"></a>Pearson Residuals</h3>
<p>The Pearson residuals are computed as the raw residuals divided by the square root of the estimated variance of the response values. Both marginal and conditional versions are available as follows.</p>

<ul>
<li><p><strong>marginal</strong> Pearson residuals <span class="math display">\[r^{m,Pearson}_{i} = \frac{r^m_i}{\sqrt{\widehat{Var}[Y_i]}}\]</span></p></li>
<li><p><strong>conditional</strong> Pearson residuals <span class="math display">\[r^{c,Pearson}_{i} = \frac{r^c_i}{\sqrt{\widehat{Var}[Y_i|\boldsymbol{\gamma}]}}\]</span></p></li>
</ul>
</div>
<div id="studentized" class="section level3">
<h3 class="hasAnchor">
<a href="#studentized" class="anchor"></a>Studentized</h3>
<p>The studentized residuals are computed as the raw residuals divided by the square root of the estimated variance of the raw residuals. Again, both marginal and conditional versions are available.</p>
<ul>
<li><p><strong>marginal</strong> Pearson residuals <span class="math display">\[r_i^{m,std}=\frac{r_i^m}{\sqrt{\widehat{Var}[r_i^m]}}\]</span></p></li>
<li><p><strong>conditional</strong> studentized residuals <span class="math display">\[r_i^{c,std}=\frac{r_i^c}{\sqrt{\widehat{Var}[r_i^c]}}\]</span></p></li>
</ul>
<p>Note that <span class="math display">\[\widehat{Var}[\textbf{r}^m]=\widehat{\textbf{V}}-\textbf{Q} \ \ \ \mbox{ and } \ \ \ \widehat{Var}[\textbf{r}^c]=\textbf{K}\left(\widehat{\textbf{V}}-\textbf{Q}\right)\textbf{K}'.\]</span> The values of <span class="math inline">\(\textbf{Q}\)</span> and <span class="math inline">\(\textbf{K}\)</span> are defined as follows by by Gregoire, Schabenberger, and Barrett (1995).</p>
<p><span class="math display">\[\textbf{Q}=\textbf{X}(\textbf{X}'\widehat{\textbf{V}}^{-1}\textbf{X})^{-}\textbf{X}' \ \ \ \mbox{ and } \ \ \ \textbf{K}=\textbf{I}-\textbf{Z}\widehat{\textbf{G}}\textbf{Z}'\widehat{\textbf{V}}^{-1}\]</span></p>
</div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>The function <code>redres</code> can compute the residuals types defined in the previous section for models fit using <code>lmer</code>.</p>
<p><strong>Inputs</strong></p>
<ul>
<li>
<code>model</code>: A model fit using <code>lmer</code> for which the residuals will be computed.</li>
<li>
<code>type</code>: A character string identifying the type of residual that will be computed. By default, the raw conditional residuals are returned. The following are the options available for type.
<ul>
<li>
<code>"pearson_cond"</code>: Pearson conditional residuals</li>
<li>
<code>"pearson_mar"</code>: Pearson marginal residuals</li>
<li>
<code>"raw_cond"</code>: raw conditional residuals (default)</li>
<li>
<code>"raw_mar"</code>: raw marginal residuals</li>
<li>
<code>"std_cond"</code>: studentized conditional residuals</li>
<li>
<code>"std_mar"</code>: studentized marginal residuals</li>
</ul>
</li>
</ul>
<p>See the section on <a href="#types">residual types</a> for details on how the residuals are computed and their purpose.</p>
<p><strong>Output</strong></p>
<ul>
<li>
<code>redres</code> returns a vector of residuals according to the type specified in the order that the data observations are input into <code>lmer</code>.</li>
</ul>
<p><strong>Functionality</strong></p>
<p>The code below demonstrates the use of <code>redres</code> to compute several types of residuals from the model <code>m</code>. These residuals are put into a dataframe and joined with the <code>sleepstudy</code> data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Computes the default residuals (raw conditional)</span>
raw_cond &lt;-<span class="st"> </span><span class="kw"><a href="../reference/redres.html">redres</a></span>(m)

<span class="co"># Computes the Pearson marginal residuals</span>
pearson_mar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/redres.html">redres</a></span>(m, <span class="dt">type =</span> <span class="st">"pearson_mar"</span>)

<span class="co"># Computes the studentized conditional residuals</span>
std_cond &lt;-<span class="st"> </span><span class="kw"><a href="../reference/redres.html">redres</a></span>(m, <span class="dt">type =</span> <span class="st">"std_cond"</span>)

<span class="co"># Joins the residuals to the paprika data</span>
paprika_plus &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(paprika, raw_cond, pearson_mar, std_cond)

<span class="co"># Prints the head of the dataframe</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(paprika_plus)
<span class="co">#&gt;   rep treatment variety plant height   raw_cond pearson_mar   std_cond</span>
<span class="co">#&gt; 1   1        T1      C1     1   23.5 -0.8171447  0.28484517 -0.1476290</span>
<span class="co">#&gt; 2   1        T1      C1     2   21.5 -2.8171447  0.04144796 -0.5089579</span>
<span class="co">#&gt; 3   1        T1      C1     3   31.2  6.8828553  1.22192446  1.2434874</span>
<span class="co">#&gt; 4   1        T1      C1     4   22.1 -2.2171447  0.11446712 -0.4005593</span>
<span class="co">#&gt; 5   1        T1      C1     5   31.5  7.1828553  1.25843404  1.2976867</span>
<span class="co">#&gt; 6   1        T1      C1     6   26.0  1.6828553  0.58909169  0.3040322</span></code></pre></div>
<p>The user can then use these residuals as desired. For example, the user could make their own plots or perform tests on the residuals. The code below creates histograms of the three residual types.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Loads helpful libraries </span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

<span class="co"># Creates histograms of the residual types</span>
paprika_plus <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="dt">key =</span> <span class="st">"type"</span>, <span class="dt">value =</span> <span class="st">"residual"</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> residual)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_histogram">geom_histogram</a></span>(<span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(. <span class="op">~</span><span class="st"> </span>type, <span class="dt">scales =</span> <span class="st">"free"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>()</code></pre></div>
<p><img src="redres-vignette_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="plotting-residuals" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-residuals" class="anchor"></a>Plotting Residuals</h1>
<div id="residual-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#residual-plots" class="anchor"></a>Residual Plots</h2>
</div>
<div id="quantile-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#quantile-plots" class="anchor"></a>Quantile plots</h2>
<p>Quantile plots are used to verify visually if data follows are particular distribution. Data points are plotted along the quantiles of the assumed distributed. The data is expected to follow an approximately straight line, at least along the middle quantiles. The points are assessed for any extreme curvation that would indicate a departure from the assumed distribution. Typically curvature at the extreme ends of the quantiles (around 0 and 1) are ignored as data is sparse here and distributions behave more erratically at the boundaries of the parameter space. We have added confidence bands to guide the user.</p>
<p>The function <code>plot_ranef</code> plots each random effect vector along the normal quantiles. From the assumptions of the linear mixed model, each random effect specified - along with the error term - is assumed to follow a normal distribution. Therefore, these plots can be used to assess if this assumption is met. Note that the number of plots generated by this function will vary for each model, with the number of plots being the number of random effects.</p>
</div>
<div id="usage-1" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-1" class="anchor"></a>Usage</h2>
<div id="plot_redres" class="section level3">
<h3 class="hasAnchor">
<a href="#plot_redres" class="anchor"></a>plot_redres</h3>
<p>The function <code>plot_redres</code> is included in the package to allow for the easy creation of a residual plot using <code>ggplot2</code> for a linear mixed model fit using <code>lmer</code>. <code>plot_redres</code> allows the user to specify any residual type to be plotted on the y-axis including those not provided by <code>lme4</code>.</p>
<p><strong>Inputs</strong></p>
<ul>
<li>
<code>model</code>: A model fit using <code>lmer</code> for which the residuals will be computed.</li>
<li>
<code>type</code>: A character string identifying the type of residual that will be computed. The same options available with <a href="#redres"><code>redres</code></a> are available for <code>plot_redres</code>. By default, the conditional raw residuals are plotted.</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li>A <code>ggplot2</code> object of a scatterplot of the model residuals of the type specified versus the fitted values is created.</li>
</ul>
<p><strong>Functionality</strong></p>
<p>The code below shows how to create the most basic plot using <code>plot_redres</code>. By inputting the model <code>m</code>, a plot of the conditional raw residuals versus the fitted values is returned.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Creates the default residual plot</span>
<span class="kw"><a href="../reference/plot_redres.html">plot_redres</a></span>(m)</code></pre></div>
<p><img src="redres-vignette_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The type of residuals can be changed using the <code>type</code> option as shown in the code below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Creates the residual plot with studentized marginal residuals</span>
<span class="kw"><a href="../reference/plot_redres.html">plot_redres</a></span>(m, <span class="dt">type =</span> <span class="st">"std_mar"</span>)</code></pre></div>
<p><img src="redres-vignette_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
<p>All plots created using the <code>redres</code> package are formatted to use <code>theme_bw</code> from <code>ggplot2</code>. However, since <code>plot_redres</code> returns a ggplot object, it is possible to use functions provided by <code>ggplot2</code> adjust the formatting of the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Applies ggplot2 formatting functions to the output from plot_resid</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="../reference/plot_redres.html">plot_redres</a></span>(m, <span class="dt">type =</span> <span class="st">"pearson_cond"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_classic</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Residual Plot"</span>)</code></pre></div>
<p><img src="redres-vignette_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="plot_resqq" class="section level3">
<h3 class="hasAnchor">
<a href="#plot_resqq" class="anchor"></a>plot_resqq</h3>
</div>
<div id="plot_ranef" class="section level3">
<h3 class="hasAnchor">
<a href="#plot_ranef" class="anchor"></a>plot_ranef</h3>
</div>
</div>
</div>
<div id="interacting-with-residuals" class="section level1">
<h1 class="hasAnchor">
<a href="#interacting-with-residuals" class="anchor"></a>Interacting with Residuals</h1>
<div id="redres_app" class="section level2">
<h2 class="hasAnchor">
<a href="#redres_app" class="anchor"></a>Shiny App</h2>
<p>The function <code>redres_app</code> includes a shiny app that helps demonstrate how the plotting functions <code>plot_redres</code>, <code>plot_resqq</code> and <code>plot_ranef</code> can be used. It can also be used to visually comparing two linear mixed models and conducting model selection through pairwise comparison.</p>
<p><strong>Inputs</strong></p>
<ul>
<li>
<code>model</code>: A model (or two models wrapped in a list) fit using <code>lmer</code>.</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li>A <code>shiny</code> app.</li>
</ul>
<p><strong>Functionality</strong></p>
<p>The code below shows how to create a <code>shiny</code> app. By inputting the model <code>m</code> (could be a list of two models), a <code>shiny</code> app which has two main tabs, one includes the residual plot with a choice of all <a href="#types">residual types</a> and a choice of different x-axis variables and another one includes the normal quantile plots is returned.</p>
</div>
<div id="usage-2" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-2" class="anchor"></a>Usage</h2>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introducing-redres">Introducing redres</a><ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#package-structure">Package Structure</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#example-data">Example Data</a></li>
      </ul>
</li>
      <li>
<a href="#extracting-residuals">Extracting Residuals</a><ul class="nav nav-pills nav-stacked">
<li><a href="#types">Residual Types</a></li>
      <li><a href="#usage">Usage</a></li>
      </ul>
</li>
      <li>
<a href="#plotting-residuals">Plotting Residuals</a><ul class="nav nav-pills nav-stacked">
<li><a href="#residual-plots">Residual Plots</a></li>
      <li><a href="#quantile-plots">Quantile plots</a></li>
      <li><a href="#usage-1">Usage</a></li>
      </ul>
</li>
      <li>
<a href="#interacting-with-residuals">Interacting with Residuals</a><ul class="nav nav-pills nav-stacked">
<li><a href="#redres_app">Shiny App</a></li>
      <li><a href="#usage-2">Usage</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Katherine Goode.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
